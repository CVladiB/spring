
flyway {
    url = "$flywayUrl"
    user = "$flywayUser"
    password = "$flywayPassword"
    schemas =['library']
    cleanDisabled = true
    locations = ["classpath:db/migration/"]
}

task flywayLog{
    group = 'flyway'
    doFirst { logger.quiet("url: ${flyway.url}\nusername: ${flyway.user}\nlocations: ${flyway.locations}") }
}


project.afterEvaluate {
    project.tasks.each {
        if(it.name.startsWith("flyway")) {
            it.dependsOn(classes)
            if (!it.name.equals("flywayLog")) {
                it.dependsOn(flywayLog)
            }
        }
    }
}